package ShoppingCart;

import java.util.ArrayList;
import java.util.Scanner;

import DataFiles.FileOrder;
import DataFiles.FileShoppingCart;

public class Order {
    private int orderID;
    private int userID;
    private double totalPrice;
    private ShoppingCart cart;
    private String status;

//----------------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------------
 
    public Order(int orderID, ShoppingCart cart){
        this.orderID = orderID;
        this.userID = cart.getUserID();
        this.totalPrice = cart.getTotalPrice();
        this.cart = cart;
        this.status = "Open";
    }

//----------------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------------
 

    public Order(int id){
        this.orderID = 0;
        this.userID = id;
        this.totalPrice = 0;
        this.status = "Open";

    }

//----------------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------------
 

    public Order(int orderID , int userID, String status , double totalPrice){
        this.orderID = orderID;
        this.userID = userID;
        this.totalPrice = totalPrice;
        this.status = status;
    } 

//----------------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------------
 

    public int getOrderID() {
        return orderID;
    }

//----------------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------------
 
    public int getUserID() {
        return userID;
    }

//----------------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------------
 
    public double getTotalPrice() {
        return totalPrice;
    }

//----------------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------------
 
    public ShoppingCart getShoppingCart() {
        return cart;
    }

//----------------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------------
 
    public String getStatus() {
        return status;
    }

//----------------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------------
 

    public void setOrderID(int orderID) {
        this.orderID = orderID;
    }

//----------------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------------
 
    public void setTotalPrice(double totalPrice) {
        this.totalPrice = totalPrice;
    }

//----------------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------------
 

    public void setStatus(String status) {
        this.status = status;
    }

//----------------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------------
 
    public void setCart(ShoppingCart cart) {
        this.cart = cart;
        this.userID = cart.getUserID();
        this.totalPrice = cart.getTotalPrice();
    }

//----------------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------------
 
    public int getShoppingCart(ArrayList<ShoppingCart> cartList , int userId) {
        for(int i = 0; i < cartList.size(); i++) {
            if(cartList.get(i).getUserID()==userId) {
                return i;
            }
        }
        return -1;
    }

//----------------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------------
 

    public int getOrder(int userId){
        FileOrder orderFile = new FileOrder();
        ArrayList<Order> orderList = orderFile.load();
        if(orderList.size()==0){
            return -2;
        }
        else{
            for(Order order : orderList){
                if(order.getUserID()==userId){
                    if(order.getStatus().equals("Closed")){
                        continue;
                    }
                    else{
                        return -1;
                    }
                }
            }
        }
        return (orderList.get(orderList.size()-1).getOrderID() +1);

    }

//----------------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------------
 
    public void makeOrder(){
        int haveOrder = getOrder(userID);
        if(haveOrder==-1){
            System.out.println("----------------------------------------------------------------------------------------------------------------------------");
            System.out.println("your order has already open , please pay for it to make new order");
            System.out.println("----------------------------------------------------------------------------------------------------------------------------");

            return;
        }
        else if(haveOrder==-2){
            this.orderID = 1;
        }else{
            this.orderID = haveOrder;
        }
        FileShoppingCart cart = new FileShoppingCart();
        ArrayList<ShoppingCart> cartList = cart.load();
        int found = getShoppingCart(cartList, userID);        
        if(found==-1) {
            System.out.println("----------------------------------------------------------------------------------------------------------------------------");
            System.out.println("you don't have the shopping cart to make order");
            System.out.println("----------------------------------------------------------------------------------------------------------------------------");

            return;
        }
        else{
            System.out.println("----------------------------------------------------------------------------------------------------------------------------");
            System.out.println("the inforamtion of your shopping cart :");
            cartList.get(found).print();
            setCart(cartList.get(found));
            System.out.println("do you want to make order for your shopping cart? (y/n) ");
            Scanner input = new Scanner(System.in);
            char choice = input.next().charAt(0);
            if(choice=='y'){
                FileOrder orderFile = new FileOrder();
                orderFile.save(this);
                System.out.println("oredr done!!");
                System.out.println("----------------------------------------------------------------------------------------------------------------------------");
            }
        }
        

    }
}

//----------------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------------
 